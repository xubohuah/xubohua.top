<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Memoization | xu-web</title>
    <meta name="description" content="by xubohua">
    <link rel="stylesheet" href="/assets/style.a8419a3e.css">
    <link rel="modulepreload" href="/assets/app.48148ea1.js">
    <link rel="modulepreload" href="/assets/React_Memoization.md.512494b9.lean.js">
    
    <link rel="icon" href="https://s1.imgbed.xyz/2022/09/09/gvRrD.png">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-ca9ccb7e><!--[--><!--]--><!--[--><span tabindex="-1" data-v-151f2593></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-151f2593> Skip to content </a><!--]--><!----><header class="VPNav" data-v-ca9ccb7e data-v-a71a30f1><div class="VPNavBar has-sidebar" data-v-a71a30f1 data-v-a35e6f52><div class="container" data-v-a35e6f52><div class="VPNavBarTitle has-sidebar" data-v-a35e6f52 data-v-d5925166><a class="title" href="/" data-v-d5925166><!--[--><!--]--><!--[--><img class="VPImage logo" src="https://img-blog.csdnimg.cn/be87a65842924af38db2238ee909546e.png" data-v-e13a1912><!--]--><!--[--> <!--]--><!--[--><!--]--></a></div><div class="content" data-v-a35e6f52><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-a35e6f52 data-v-f83db6ba><span id="main-nav-aria-label" class="visually-hidden" data-v-f83db6ba>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->首页<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/web/" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->web<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/interview/" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->interview<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/React/" data-v-f83db6ba data-v-47a2263e data-v-3c355974><!--[-->React<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-a35e6f52 data-v-a3e7452b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-a3e7452b data-v-968780f1 data-v-086e8519><span class="check" data-v-086e8519><span class="icon" data-v-086e8519><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-968780f1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-968780f1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-a35e6f52 data-v-738bef5a data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://github.com/xubohuah" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-a35e6f52 data-v-e89b88d7 data-v-6ffb57d3><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-6ffb57d3><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-6ffb57d3><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-6ffb57d3><div class="VPMenu" data-v-6ffb57d3 data-v-1c5d0cfc><!----><!--[--><!--[--><!----><div class="group" data-v-e89b88d7><div class="item appearance" data-v-e89b88d7><p class="label" data-v-e89b88d7>Appearance</p><div class="appearance-action" data-v-e89b88d7><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-e89b88d7 data-v-968780f1 data-v-086e8519><span class="check" data-v-086e8519><span class="icon" data-v-086e8519><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-968780f1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-968780f1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-e89b88d7><div class="item social-links" data-v-e89b88d7><div class="VPSocialLinks social-links-list" data-v-e89b88d7 data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://github.com/xubohuah" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-a35e6f52 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-ca9ccb7e data-v-aac27d5e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-aac27d5e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-aac27d5e><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-aac27d5e>Menu</span></button><a class="top-link" href="#" data-v-aac27d5e> Return to top </a></div><aside class="VPSidebar" data-v-ca9ccb7e data-v-f332cb62><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-f332cb62><span class="visually-hidden" id="sidebar-aria-label" data-v-f332cb62> Sidebar Navigation </span><!--[--><div class="group" data-v-f332cb62><section class="VPSidebarGroup" data-v-f332cb62 data-v-2976c796><div class="title" data-v-2976c796><h2 class="title-text" data-v-2976c796>React_hooks📝</h2><div class="action" data-v-2976c796><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-2976c796><!--[--><a class="VPLink link link" href="/React/props%20daring.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>props daring</span><!----><!--]--><!----></a><a class="VPLink link link" href="/React/WeatherReact.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Weather_react</span><!----><!--]--><!----></a><a class="VPLink link link active" href="/React/Memoization.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Memoization</span><!----><!--]--><!----></a><a class="VPLink link link" href="/React/useState.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>useState</span><!----><!--]--><!----></a><a class="VPLink link link" href="/React/useContext%20-useReducer.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>useContext -useReducer</span><!----><!--]--><!----></a><a class="VPLink link link" href="/React/useReducer-useState.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>useReducer-useState</span><!----><!--]--><!----></a><!--]--></div></section></div><div class="group" data-v-f332cb62><section class="VPSidebarGroup" data-v-f332cb62 data-v-2976c796><div class="title" data-v-2976c796><h2 class="title-text" data-v-2976c796>react-patterns📝</h2><div class="action" data-v-2976c796><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-2976c796><!--[--><a class="VPLink link link" href="/React/reactpatterns/ContextModuleFunctions.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>Context Module Functions</span><!----><!--]--><!----></a><a class="VPLink link link" href="/React/reactpatterns/CompoundComponents.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>CompoundComponents</span><!----><!--]--><!----></a><!--]--></div></section></div><div class="group" data-v-f332cb62><section class="VPSidebarGroup" data-v-f332cb62 data-v-2976c796><div class="title" data-v-2976c796><h2 class="title-text" data-v-2976c796>redux📝</h2><div class="action" data-v-2976c796><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-2976c796><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-2976c796><!--[--><a class="VPLink link link" href="/React/redux_toolkit.html" data-v-2976c796 data-v-f7e544fc data-v-3c355974><!--[--><span class="link-text" data-v-f7e544fc>redux_toolkit</span><!----><!--]--><!----></a><!--]--></div></section></div><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-ca9ccb7e data-v-c95df128><div class="VPDoc has-sidebar has-aside" data-v-c95df128 data-v-f0af2311><div class="container" data-v-f0af2311><div class="aside" data-v-f0af2311><div class="aside-curtain" data-v-f0af2311></div><div class="aside-container" data-v-f0af2311><div class="aside-content" data-v-f0af2311><div class="VPDocAside" data-v-f0af2311 data-v-aea49c31><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline has-outline" data-v-aea49c31 data-v-a3de185c><div class="content" data-v-a3de185c><div class="outline-marker" data-v-a3de185c></div><div class="outline-title" data-v-a3de185c>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-a3de185c><span class="visually-hidden" id="doc-outline-aria-label" data-v-a3de185c> Table of Contents for current page </span><ul class="root" data-v-a3de185c><!--[--><li data-v-a3de185c><a class="outline-link" href="#函数组件实现-memoization" data-v-a3de185c>函数组件实现 Memoization</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#类组件实现-memoization" data-v-a3de185c>类组件实现 Memoization</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#react-memo-存在的问题（使用usememo也可以处理）" data-v-a3de185c>React.memo() 存在的问题（使用useMemo也可以处理）</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#usecallback是uesmemo的一个语法糖（更好的处理函数-直接写）" data-v-a3de185c>useCallback是uesMemo的一个语法糖（更好的处理函数_直接写）</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#通过-usecallback-来避免更多的重复渲染" data-v-a3de185c>通过 useCallback() 来避免更多的重复渲染</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#值得注意的事" data-v-a3de185c>值得注意的事</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#总结" data-v-a3de185c>总结</a><!----></li><li data-v-a3de185c><a class="outline-link" href="#斐波那契数列-缓存" data-v-a3de185c>斐波那契数列 缓存</a><!----></li><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-aea49c31></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-f0af2311><div class="content-container" data-v-f0af2311><!--[--><!--]--><main class="main" data-v-f0af2311><div style="position:relative;" class="vp-doc _React_Memoization" data-v-f0af2311><div><h1 id="memoization" tabindex="-1">Memoization <a class="header-anchor" href="#memoization" aria-hidden="true">#</a></h1><p>在 React 应用的上下文中，Memoization 是一种手段，每当父组件重新渲染时，子组件仅在它所依赖的 props 发生变化时才会重新渲染。如果子组件所依赖的 props 中没有更改，则它不会执行 render 方法，并将返回缓存的结果。由于渲染方法未执行，因此不会有虚拟 DOM 创建和差异检查，从而实现性能的提升。</p><p>现在，让我们看看如何在类和函数组件中实现 Memoization，以避免这种不必要的重新渲染。</p><h2 id="函数组件实现-memoization" tabindex="-1">函数组件实现 Memoization <a class="header-anchor" href="#函数组件实现-memoization" aria-hidden="true">#</a></h2><p>为了在函数组件中实现 Memoization，我们将使用 <a href="https://link.juejin.cn?target=https%3A%2F%2Freactjs.org%2Fdocs%2Freact-api.html%23reactmemo" target="_blank" rel="noreferrer">React.memo()</a>。<code>React.memo()</code> 是一个<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.sitepoint.com%2Freact-higher-order-components%2F" target="_blank" rel="noreferrer">高阶组件</a>（HOC），它执行与 <code>PureComponent</code> 类似的工作，来避免不必要的重新渲染。</p><p>以下是函数组件的代码：</p><div class="language-jsx line-numbers-mode"><button class="copy"></button><span class="lang">jsx</span><pre><code><span class="line"><span style="color:#8B949E;">//Child.js</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">Child</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">props</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  console.</span><span style="color:#D2A8FF;">log</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;Child render&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#7EE787;">div</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">      &lt;</span><span style="color:#7EE787;">h2</span><span style="color:#C9D1D9;">&gt;</span><span style="color:#FF7B72;">{</span><span style="color:#C9D1D9;">props.name</span><span style="color:#FF7B72;">}</span><span style="color:#C9D1D9;">&lt;/</span><span style="color:#7EE787;">h2</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;/</span><span style="color:#7EE787;">div</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">  );</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">default</span><span style="color:#FFA657;"> </span><span style="color:#C9D1D9;">React</span><span style="color:#FFA657;">.</span><span style="color:#D2A8FF;">memo</span><span style="color:#FFA657;">(</span><span style="color:#C9D1D9;">Child</span><span style="color:#FFA657;">)</span><span style="color:#C9D1D9;">; </span><span style="color:#8B949E;">// 这里我们给子组件添加 HOC 实现 Memoization</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="类组件实现-memoization" tabindex="-1">类组件实现 Memoization <a class="header-anchor" href="#类组件实现-memoization" aria-hidden="true">#</a></h2><p>为了在类组件中实现 Memoization，我们将使用 <a href="https://link.juejin.cn?target=https%3A%2F%2Freactjs.org%2Fdocs%2Freact-api.html%23reactpurecomponent" target="_blank" rel="noreferrer">React.PureComponent</a>。<code>React.PureComponent</code> 实现了 <a href="https://link.juejin.cn?target=https%3A%2F%2Freactjs.org%2Fdocs%2Freact-component.html%23shouldcomponentupdate" target="_blank" rel="noreferrer">shouldComponentUpdate()</a>，它对 <code>state</code> 和 <code>props</code> 进行了浅比较，并且仅在 props 或 state 发生更改时才重新渲染 React 组件。</p><p>将子组件更改为如下所示的代码：</p><div class="language-jsx line-numbers-mode"><button class="copy"></button><span class="lang">jsx</span><pre><code><span class="line"><span style="color:#8B949E;">//Child.js</span></span>
<span class="line"><span style="color:#FF7B72;">class</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">Child</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">extends</span><span style="color:#C9D1D9;"> </span><span style="color:#FFA657;">React</span><span style="color:#C9D1D9;">.</span><span style="color:#79C0FF;">PureComponent</span><span style="color:#C9D1D9;"> { </span><span style="color:#8B949E;">// 这里我们把 React.Component 改成了 React.PureComponent</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#D2A8FF;">render</span><span style="color:#C9D1D9;">() {</span></span>
<span class="line"><span style="color:#C9D1D9;">    console.</span><span style="color:#D2A8FF;">log</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;Child render&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">      &lt;</span><span style="color:#7EE787;">div</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">        &lt;</span><span style="color:#7EE787;">h2</span><span style="color:#C9D1D9;">&gt;</span><span style="color:#FF7B72;">{</span><span style="color:#79C0FF;">this</span><span style="color:#C9D1D9;">.props.name</span><span style="color:#FF7B72;">}</span><span style="color:#C9D1D9;">&lt;/</span><span style="color:#7EE787;">h2</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">      &lt;/</span><span style="color:#7EE787;">div</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    );</span></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">default</span><span style="color:#FFA657;"> </span><span style="color:#C9D1D9;">Child;</span></span>
<span class="line"><span style="color:#C9D1D9;">复制代码</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>此示例的完整代码显示在这个 <a href="https://link.juejin.cn?target=https%3A%2F%2Fjwt2q.csb.app%2F" target="_blank" rel="noreferrer">sandbox</a> 中。</p><p>父组件保持不变。现在，当我们在父组件中增加 <code>count</code> 时，控制台中的输出如下所示：</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#c9d1d9;">Parent render</span></span>
<span class="line"><span style="color:#c9d1d9;">Child render</span></span>
<span class="line"><span style="color:#c9d1d9;">Parent render</span></span>
<span class="line"><span style="color:#c9d1d9;">Parent render</span></span>
<span class="line"><span style="color:#c9d1d9;">复制代码</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>对于首次渲染，它同时调用父组件和子组件的 <code>render</code> 方法。</p><p>对于每次增加 <code>count</code> 后的重新渲染，仅调用父组件的 <code>render</code> 函数。子组件不会重新渲染。</p><h2 id="react-memo-存在的问题（使用usememo也可以处理）" tabindex="-1">React.memo() 存在的问题（使用useMemo也可以处理） <a class="header-anchor" href="#react-memo-存在的问题（使用usememo也可以处理）" aria-hidden="true">#</a></h2><h2 id="usecallback是uesmemo的一个语法糖（更好的处理函数-直接写）" tabindex="-1">useCallback是uesMemo的一个语法糖（更好的处理函数_直接写） <a class="header-anchor" href="#usecallback是uesmemo的一个语法糖（更好的处理函数-直接写）" aria-hidden="true">#</a></h2><p>在上面的示例中，我们看到，当我们对子组件使用 <code>React.memo()</code> HOC 时，子组件没有重新渲染，即使父组件重新渲染了。</p><p>但是，需要注意的一个小问题是，如果我们将函数作为参数传递给子组件，即使在使用 <code>React.memo()</code> 之后，子组件也会重新渲染。让我们看一个这样的例子。</p><p>我们将更改父组件，如下所示。在这里，我们添加了一个处理函数，并作为参数传递给子组件：</p><div class="language-jsx line-numbers-mode"><button class="copy"></button><span class="lang">jsx</span><pre><code><span class="line"><span style="color:#8B949E;">//Parent.js</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">default</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">function</span><span style="color:#FFA657;"> </span><span style="color:#D2A8FF;">Parent</span><span style="color:#FFA657;">() </span><span style="color:#C9D1D9;">{</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> [</span><span style="color:#79C0FF;">count</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">setCount</span><span style="color:#C9D1D9;">] </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">useState</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">handleClick</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> () </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">setCount</span><span style="color:#C9D1D9;">(count </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">1</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">handler</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> () </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    console.</span><span style="color:#D2A8FF;">log</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;handler&quot;</span><span style="color:#C9D1D9;">);    </span><span style="color:#8B949E;">// 这里的 handler 函数将会被传递给子组件</span></span>
<span class="line"><span style="color:#C9D1D9;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  console.</span><span style="color:#D2A8FF;">log</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;Parent render&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#7EE787;">div</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">className</span><span style="color:#FF7B72;">=</span><span style="color:#A5D6FF;">&quot;App&quot;</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">      &lt;</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">onClick</span><span style="color:#FF7B72;">={</span><span style="color:#C9D1D9;">handleClick</span><span style="color:#FF7B72;">}</span><span style="color:#C9D1D9;">&gt;Increment&lt;/</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">      &lt;</span><span style="color:#7EE787;">h2</span><span style="color:#C9D1D9;">&gt;</span><span style="color:#FF7B72;">{</span><span style="color:#C9D1D9;">count</span><span style="color:#FF7B72;">}</span><span style="color:#C9D1D9;">&lt;/</span><span style="color:#7EE787;">h2</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">      &lt;</span><span style="color:#7EE787;">Child</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">name</span><span style="color:#FF7B72;">={</span><span style="color:#A5D6FF;">&quot;joe&quot;</span><span style="color:#FF7B72;">}</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">childFunc</span><span style="color:#FF7B72;">={</span><span style="color:#C9D1D9;">handler</span><span style="color:#FF7B72;">}</span><span style="color:#C9D1D9;"> /&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;/</span><span style="color:#7EE787;">div</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">  );</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"><span style="color:#C9D1D9;">复制代码</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>子组件代码将保持原样。我们不会在子组件中使用父组件传递来的函数：</p><div class="language-jsx line-numbers-mode"><button class="copy"></button><span class="lang">jsx</span><pre><code><span class="line"><span style="color:#8B949E;">//Child.js</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">Child</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">props</span><span style="color:#C9D1D9;">) {</span></span>
<span class="line"><span style="color:#C9D1D9;">  console.</span><span style="color:#D2A8FF;">log</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;Child render&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#7EE787;">div</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">      &lt;</span><span style="color:#7EE787;">h2</span><span style="color:#C9D1D9;">&gt;</span><span style="color:#FF7B72;">{</span><span style="color:#C9D1D9;">props.name</span><span style="color:#FF7B72;">}</span><span style="color:#C9D1D9;">&lt;/</span><span style="color:#7EE787;">h2</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;/</span><span style="color:#7EE787;">div</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">  );</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">default</span><span style="color:#FFA657;"> </span><span style="color:#C9D1D9;">React</span><span style="color:#FFA657;">.</span><span style="color:#D2A8FF;">memo</span><span style="color:#FFA657;">(</span><span style="color:#C9D1D9;">Child</span><span style="color:#FFA657;">)</span><span style="color:#C9D1D9;">;</span></span>
<span class="line"><span style="color:#C9D1D9;">复制代码</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>现在，当我们递增父组件中的 <code>count</code> 时，它会重新渲染并同时重新渲染子组件，即使传递的参数中没有更改。</p><p>那么，是什么原因导致子组件重新渲染的呢？答案是，每次父组件重新渲染时，都会创建一个新的 <code>handler</code> 函数并将其传递给子组件。现在，由于每次重新渲染时都会重新创建 <code>handle</code> 函数，因此子组件在对 props 进行浅比较时会发现 <code>handler</code> 引用已更改，并重新渲染子组件。</p><h2 id="通过-usecallback-来避免更多的重复渲染" tabindex="-1">通过 <code>useCallback()</code> 来避免更多的重复渲染 <a class="header-anchor" href="#通过-usecallback-来避免更多的重复渲染" aria-hidden="true">#</a></h2><p>导致子组件重新渲染的主要问题是重新创建了 <code>handler</code> 函数，这更改了传递给子组件的引用。因此，我们需要有一种方法来避免这种重复创建。如果未重新创建 <code>handler</code> 函数，则对 <code>handler</code> 函数的引用不会更改，因此子组件不会重新渲染。</p><p>为了避免每次渲染父组件时都重新创建函数，我们将使用一个名为 <a href="https://link.juejin.cn?target=https%3A%2F%2Freactjs.org%2Fdocs%2Fhooks-reference.html%23usecallback" target="_blank" rel="noreferrer">useCallback()</a> 的 React Hook。Hooks 是在 React 16 中引入的。要了解有关 Hooks 的更多信息，你可以查看 React 的官方 <a href="https://link.juejin.cn?target=https%3A%2F%2Freactjs.org%2Fdocs%2Fhooks-intro.html" target="_blank" rel="noreferrer">hooks 文档</a>，或者查看 `<a href="https://link.juejin.cn?target=https%3A%2F%2Fwww.sitepoint.com%2Freact-hooks%2F" target="_blank" rel="noreferrer">React Hooks: How to Get Started &amp; Build Your Own</a>&quot;。</p><p><code>useCallback()</code> 钩子传入两个参数：回调函数和依赖项列表。</p><p>以下是 <code>useCallback()</code> 示例：</p><div class="language-jsx line-numbers-mode"><button class="copy"></button><span class="lang">jsx</span><pre><code><span class="line"><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">handleClick</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">useCallback</span><span style="color:#C9D1D9;">(() </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#8B949E;">//Do something</span></span>
<span class="line"><span style="color:#C9D1D9;">}, [x,y]);</span></span>
<span class="line"><span style="color:#C9D1D9;">复制代码</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>在这里，<code>useCallback()</code> 被添加到 <code>handleClick()</code> 函数中。第二个参数 <code>[x, y]</code> 可以是空数组、单个依赖项或依赖项列表。每当第二个参数中提到的任何依赖项发生更改时，才会重新创建 <code>handleClick()</code> 函数。</p><p>如果 <code>useCallback()</code> 中提到的依赖项没有更改，则返回作为第一个参数提及的回调函数的 Memoization 版本。我们将更改父组件，以便对传递给子组件的处理程序使用 <code>useCallback()</code> 钩子：</p><div class="language-JSX line-numbers-mode"><button class="copy"></button><span class="lang">JSX</span><pre><code><span class="line"><span style="color:#8B949E;">//Parent.js</span></span>
<span class="line"><span style="color:#FF7B72;">export</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">default</span><span style="color:#FFA657;"> </span><span style="color:#FF7B72;">function</span><span style="color:#FFA657;"> </span><span style="color:#D2A8FF;">Parent</span><span style="color:#FFA657;">() </span><span style="color:#C9D1D9;">{</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> [</span><span style="color:#79C0FF;">count</span><span style="color:#C9D1D9;">, </span><span style="color:#79C0FF;">setCount</span><span style="color:#C9D1D9;">] </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">useState</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">0</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">handleClick</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> () </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> {</span></span>
<span class="line"><span style="color:#C9D1D9;">    </span><span style="color:#D2A8FF;">setCount</span><span style="color:#C9D1D9;">(count </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">1</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">const</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">handler</span><span style="color:#C9D1D9;"> </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">useCallback</span><span style="color:#C9D1D9;">(() </span><span style="color:#FF7B72;">=&gt;</span><span style="color:#C9D1D9;"> { </span><span style="color:#8B949E;">// 给 handler 函数使用 useCallback()</span></span>
<span class="line"><span style="color:#C9D1D9;">    console.</span><span style="color:#D2A8FF;">log</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;handler&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">  }, []);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  console.</span><span style="color:#D2A8FF;">log</span><span style="color:#C9D1D9;">(</span><span style="color:#A5D6FF;">&quot;Parent render&quot;</span><span style="color:#C9D1D9;">);</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> (</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;</span><span style="color:#7EE787;">div</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">className</span><span style="color:#FF7B72;">=</span><span style="color:#A5D6FF;">&quot;App&quot;</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">      &lt;</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">onClick</span><span style="color:#FF7B72;">={</span><span style="color:#C9D1D9;">handleClick</span><span style="color:#FF7B72;">}</span><span style="color:#C9D1D9;">&gt;Increment&lt;/</span><span style="color:#7EE787;">button</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">      &lt;</span><span style="color:#7EE787;">h2</span><span style="color:#C9D1D9;">&gt;</span><span style="color:#FF7B72;">{</span><span style="color:#C9D1D9;">count</span><span style="color:#FF7B72;">}</span><span style="color:#C9D1D9;">&lt;/</span><span style="color:#7EE787;">h2</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">      &lt;</span><span style="color:#7EE787;">Child</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">name</span><span style="color:#FF7B72;">={</span><span style="color:#A5D6FF;">&quot;joe&quot;</span><span style="color:#FF7B72;">}</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">childFunc</span><span style="color:#FF7B72;">={</span><span style="color:#C9D1D9;">handler</span><span style="color:#FF7B72;">}</span><span style="color:#C9D1D9;"> /&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">    &lt;/</span><span style="color:#7EE787;">div</span><span style="color:#C9D1D9;">&gt;</span></span>
<span class="line"><span style="color:#C9D1D9;">  );</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"><span style="color:#C9D1D9;">复制代码</span></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>子组件代码将保持原样。</p><p>此示例的完整代码这个 <a href="https://link.juejin.cn?target=https%3A%2F%2Fr797x.csb.app%2F" target="_blank" rel="noreferrer">sandbox</a> 中。</p><p>当我们在上述代码的父组件中增加 <code>count</code> 时，我们可以看到以下输出：</p><div class="language- line-numbers-mode"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#c9d1d9;">Parent render</span></span>
<span class="line"><span style="color:#c9d1d9;">Child render</span></span>
<span class="line"><span style="color:#c9d1d9;">Parent render</span></span>
<span class="line"><span style="color:#c9d1d9;">Parent render</span></span>
<span class="line"><span style="color:#c9d1d9;">Parent render</span></span>
<span class="line"><span style="color:#c9d1d9;">复制代码</span></span>
<span class="line"><span style="color:#c9d1d9;"></span></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>由于我们对父组件中的 <code>handler</code> 使用了 <code>useCallback()</code> 钩子，因此每次父组件重新渲染时，都不会重新创建 <code>handler</code> 函数，并且会将 <code>handler</code> 的 Memoization 版本传递到子组件。子组件将进行浅比较，并注意到 <code>handler</code> 函数的引用没有更改，因此它不会调用 <code>render</code> 方法。</p><h2 id="值得注意的事" tabindex="-1">值得注意的事 <a class="header-anchor" href="#值得注意的事" aria-hidden="true">#</a></h2><p>Memoization 是一种很好的手段，可以避免在组件的 state 或 props 没有改变时对组件进行不必要的重新渲染，从而提高 React 应用的性能。你可能会考虑为所有组件添加 Memoization，但这并不一定是构建高性能 React 组件的方法。只有在组件出现以下情况时，才应使用 Memoization：</p><ul><li>固定的输入有固定的输出时</li><li>具有较多 UI 元素，虚拟 DOM 检查将影响性能</li><li>多次传递相同的参数</li></ul><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-hidden="true">#</a></h2><p>在本教程中，我们理解了：</p><ul><li>React 是如何渲染 UI 的</li><li>为什么需要 Memoization</li><li>如何在 React 中通过函数组件的 <code>React.memo()</code> 和类组件的 <code>React.PureComponent</code> 实现 Memoization</li><li>通过一个例子展示，即使在使用 <code>React.memo()</code> 之后，子组件也会重新渲染</li><li>如何使用 <code>useCallback()</code> 钩子来避免在函数作为 props 传递给子组件时产生重新渲染的问题</li></ul><h2 id="斐波那契数列-缓存" tabindex="-1">斐波那契数列 缓存 <a class="header-anchor" href="#斐波那契数列-缓存" aria-hidden="true">#</a></h2><div class="language-js line-numbers-mode"><button class="copy"></button><span class="lang">js</span><pre><code><span class="line"><span style="color:#FF7B72;">function</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">fibonacci</span><span style="color:#C9D1D9;">(</span><span style="color:#FFA657;">n</span><span style="color:#C9D1D9;">){</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;">(n </span><span style="color:#FF7B72;">==</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">1</span><span style="color:#FF7B72;">||</span><span style="color:#C9D1D9;">n </span><span style="color:#FF7B72;">==</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">2</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">1</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">if</span><span style="color:#C9D1D9;">(</span><span style="color:#FF7B72;">!</span><span style="color:#C9D1D9;">fibonacci[n]){</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">      fibonacci[n] </span><span style="color:#FF7B72;">=</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">fibonacci</span><span style="color:#C9D1D9;">(n </span><span style="color:#FF7B72;">-</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">1</span><span style="color:#C9D1D9;">) </span><span style="color:#FF7B72;">+</span><span style="color:#C9D1D9;"> </span><span style="color:#D2A8FF;">fibonacci</span><span style="color:#C9D1D9;">(n </span><span style="color:#FF7B72;">-</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">2</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C9D1D9;">  }</span></span>
<span class="line"><span style="color:#C9D1D9;">  console.</span><span style="color:#D2A8FF;">log</span><span style="color:#C9D1D9;">(fibonacci[n],n)</span></span>
<span class="line"><span style="color:#C9D1D9;">  console.</span><span style="color:#D2A8FF;">dir</span><span style="color:#C9D1D9;">(fibonacci)</span></span>
<span class="line"><span style="color:#C9D1D9;">  </span><span style="color:#FF7B72;">return</span><span style="color:#C9D1D9;"> fibonacci[n]</span></span>
<span class="line"><span style="color:#C9D1D9;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D2A8FF;">fibonacci</span><span style="color:#C9D1D9;">(</span><span style="color:#79C0FF;">5</span><span style="color:#C9D1D9;">)</span></span>
<span class="line"><span style="color:#FF7B72;">&gt;&gt;</span><span style="color:#C9D1D9;"> </span><span style="color:#79C0FF;">5</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>函数添加了很多属性，占了不少空间，属于用空间换时间的算法。具体用不用，就取决于使用者的空间成本和时间成本</p><p>1.普通递归计算:</p><pre data-index="0" class="prettyprint"><code class="prism language-javascript has-numbering" onclick="mdcp.copyCode(event)" style="position:unset;"><span class="token keyword">function</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token operator">||</span>n <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span>
    <span class="token keyword">return</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token comment">// &gt; 5</span>
<span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
<span class="token comment">// &gt;       卡住了</span>
<div class="hljs-button {2}" data-title="复制"></div></code><ul class="pre-numbering" style=""><li style="color:rgb(153, 153, 153);">1</li><li style="color:rgb(153, 153, 153);">2</li><li style="color:rgb(153, 153, 153);">3</li><li style="color:rgb(153, 153, 153);">4</li><li style="color:rgb(153, 153, 153);">5</li><li style="color:rgb(153, 153, 153);">6</li><li style="color:rgb(153, 153, 153);">7</li><li style="color:rgb(153, 153, 153);">8</li></ul></pre><p>当n等于1或者n等于2的时候，直接返回1，当n大于2的时候，就递归函数，每次返回前两个函数的结果，这就是最基础的斐波那契数列递归算法。但是大家都知道，函数运行的时候，会被放入函数执行栈运行，如果内部还有函数，那么就会继续入栈，直到最内部函数，然后再一个个出栈，直到栈清空，取得结果。把上边的函数放入控制台运行，就会发现，当n比较大的时候，大概50以上函数栈就会非常大，以至于计算机几分钟内不能算出结果。那么可想而知，当n越来越大的时候，用这个函数，几乎不能算出结果了。所以我们可以用尾递归去优化它。</p><p>2：尾递归计算：</p><pre data-index="1" class="prettyprint"><code class="prism language-javascript has-numbering" onclick="mdcp.copyCode(event)" style="position:unset;"><span class="token keyword">function</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>a1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>a2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token operator">||</span>n <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span> a2
    <span class="token keyword">return</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>a2<span class="token punctuation">,</span>a1 <span class="token operator">+</span> a2<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span> <span class="token number">5</span>
<span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span> <span class="token number">12586269025</span>
<div class="hljs-button {2}" data-title="复制"></div></code><ul class="pre-numbering" style=""><li style="color:rgb(153, 153, 153);">1</li><li style="color:rgb(153, 153, 153);">2</li><li style="color:rgb(153, 153, 153);">3</li><li style="color:rgb(153, 153, 153);">4</li><li style="color:rgb(153, 153, 153);">5</li><li style="color:rgb(153, 153, 153);">6</li><li style="color:rgb(153, 153, 153);">7</li><li style="color:rgb(153, 153, 153);">8</li></ul></pre><p>从这个函数可以看出，我们的递归每次返回的时候，我们把计算结果传入下一个函数，return放在最后，只返回一个函数调用，那么上一个函数其实是已经结束了函数的调用的，此时他会从栈中弹出，那么函数执行栈始终只有一个。把这段函数复制到控制台运行，可以看出，即便是n很大，也能很快算出结果。<br> 细心的同学可能发现了，这其实就是一个迭代啊，只不过把迭代计算放入了递归函数的参数中。</p><p>3：迭代计算：</p><pre data-index="2" class="prettyprint"><code class="prism language-javascript has-numbering" onclick="mdcp.copyCode(event)" style="position:unset;"><span class="token keyword">function</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token operator">||</span>n <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span>
    <span class="token keyword">let</span> a1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>a2 <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token punctuation">[</span>a1<span class="token punctuation">,</span>a2<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>a2<span class="token punctuation">,</span>a1<span class="token operator">+</span>a2<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> a2
<span class="token punctuation">}</span>
<span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span> <span class="token number">5</span>
<span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span> <span class="token number">12586269025</span>
<div class="hljs-button {2}" data-title="复制"></div></code><ul class="pre-numbering" style=""><li style="color:rgb(153, 153, 153);">1</li><li style="color:rgb(153, 153, 153);">2</li><li style="color:rgb(153, 153, 153);">3</li><li style="color:rgb(153, 153, 153);">4</li><li style="color:rgb(153, 153, 153);">5</li><li style="color:rgb(153, 153, 153);">6</li><li style="color:rgb(153, 153, 153);">7</li><li style="color:rgb(153, 153, 153);">8</li><li style="color:rgb(153, 153, 153);">9</li><li style="color:rgb(153, 153, 153);">10</li><li style="color:rgb(153, 153, 153);">11</li><li style="color:rgb(153, 153, 153);">12</li></ul></pre><p>普通的迭代计算，也可以很快计算出结果。</p><p>4:缓存计算结果：</p><pre data-index="3" class="prettyprint"><code class="prism language-javascript has-numbering" onclick="mdcp.copyCode(event)" style="position:unset;"><span class="token keyword">function</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">1</span><span class="token operator">||</span>n <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>fibonacci<span class="token punctuation">[</span>n<span class="token operator">+</span><span class="token string">&#39;&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        fibonacci<span class="token punctuation">[</span>n<span class="token operator">+</span><span class="token string">&#39;&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> fibonacci<span class="token punctuation">[</span>n<span class="token operator">+</span><span class="token string">&#39;&#39;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span> <span class="token number">5</span>
<span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span> <span class="token number">12586269025</span>
<span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token operator">&gt;&gt;</span> <span class="token number">354224848179262000000</span>
<div class="hljs-button {2}" data-title="复制"></div></code><ul class="pre-numbering" style=""><li style="color:rgb(153, 153, 153);">1</li><li style="color:rgb(153, 153, 153);">2</li><li style="color:rgb(153, 153, 153);">3</li><li style="color:rgb(153, 153, 153);">4</li><li style="color:rgb(153, 153, 153);">5</li><li style="color:rgb(153, 153, 153);">6</li><li style="color:rgb(153, 153, 153);">7</li><li style="color:rgb(153, 153, 153);">8</li><li style="color:rgb(153, 153, 153);">9</li><li style="color:rgb(153, 153, 153);">10</li><li style="color:rgb(153, 153, 153);">11</li><li style="color:rgb(153, 153, 153);">12</li><li style="color:rgb(153, 153, 153);">13</li></ul></pre><p>这里咱们用缓存计算结果修改第一个普通递归，刚才分析了，普通递归因为函数执行栈太大以至于难以计算出n很大的结果，那么咱们用函数的属性，存放那些已经计算过的结果，如果有，就直接返回，没有的话，给对应的属性 n 赋值再返回，也可以很快计算出结果。但是给函数添加了很多属性，毕竟是占了不少空间，这属于用空间换时间的算法。具体用不用，就取决于使用者的空间成本和时间成本了。</p></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-f0af2311 data-v-a54a85bd><!----><div class="prev-next" data-v-a54a85bd><div class="pager" data-v-a54a85bd><a class="pager-link prev" href="/React/WeatherReact.html" data-v-a54a85bd><span class="desc" data-v-a54a85bd>Previous page</span><span class="title" data-v-a54a85bd>Weather_react</span></a></div><div class="has-prev pager" data-v-a54a85bd><a class="pager-link next" href="/React/useState.html" data-v-a54a85bd><span class="desc" data-v-a54a85bd>Next page</span><span class="title" data-v-a54a85bd>useState</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-ca9ccb7e data-v-9f24cc86><div class="container" data-v-9f24cc86><p class="message" data-v-9f24cc86>一切足够先进的技术都与魔法无异</p><p class="copyright" data-v-9f24cc86>© 2022-present XU BOHUA</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"react_memoization.md\":\"512494b9\",\"react_weatherreact.md\":\"c287149b\",\"react_index.md\":\"e883341e\",\"react_props daring.md\":\"c46a084a\",\"react_reactpatterns_compoundcomponents.md\":\"b3b9518f\",\"react_reactpatterns_contextmodulefunctions.md\":\"88e7c192\",\"react_redux_toolkit.md\":\"97c7ac0b\",\"react_usecontext -usereducer.md\":\"eb9c245a\",\"react_usereducer-usestate.md\":\"6e04bc75\",\"react_usestate.md\":\"1f897b64\",\"index.md\":\"c0839c24\",\"interview_diff.md\":\"edb6cb89\",\"interview_index.md\":\"f99a7a15\",\"promise.md\":\"4543bd92\",\"web_index.md\":\"2779f7ea\",\"web_js_index.md\":\"931b9ce5\",\"web_js_js.md\":\"64bffb5e\",\"web_js_promise.md\":\"661ea15f\",\"web_js_throttle.md\":\"09c4bde1\",\"web_js_运算符_可选链操作符（.）.md\":\"864ea5f3\",\"web_js_运算符_空值合并运算符（）.md\":\"718dce05\"}")</script>
    <script type="module" async src="/assets/app.48148ea1.js"></script>
    
  </body>
</html>